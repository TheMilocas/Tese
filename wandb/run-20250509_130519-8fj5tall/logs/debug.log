2025-05-09 13:05:19,683 INFO    MainThread:723405 [wandb_setup.py:_flush():67] Current SDK version is 0.19.9
2025-05-09 13:05:19,684 INFO    MainThread:723405 [wandb_setup.py:_flush():67] Configure stats pid to 723405
2025-05-09 13:05:19,684 INFO    MainThread:723405 [wandb_setup.py:_flush():67] Loading settings from /home/csantiago/.config/wandb/settings
2025-05-09 13:05:19,684 INFO    MainThread:723405 [wandb_setup.py:_flush():67] Loading settings from /home/csantiago/wandb/settings
2025-05-09 13:05:19,684 INFO    MainThread:723405 [wandb_setup.py:_flush():67] Loading settings from environment variables
2025-05-09 13:05:19,684 INFO    MainThread:723405 [wandb_init.py:setup_run_log_directory():662] Logging user logs to /home/csantiago/wandb/run-20250509_130519-8fj5tall/logs/debug.log
2025-05-09 13:05:19,684 INFO    MainThread:723405 [wandb_init.py:setup_run_log_directory():663] Logging internal logs to /home/csantiago/wandb/run-20250509_130519-8fj5tall/logs/debug-internal.log
2025-05-09 13:05:19,684 INFO    MainThread:723405 [wandb_init.py:init():781] calling init triggers
2025-05-09 13:05:19,684 INFO    MainThread:723405 [wandb_init.py:init():786] wandb.init called with sweep_config: {}
config: {'_wandb': {}}
2025-05-09 13:05:19,684 INFO    MainThread:723405 [wandb_init.py:init():809] starting backend
2025-05-09 13:05:19,685 INFO    MainThread:723405 [wandb_init.py:init():813] sending inform_init request
2025-05-09 13:05:19,695 INFO    MainThread:723405 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-05-09 13:05:19,695 INFO    MainThread:723405 [wandb_init.py:init():823] backend started and connected
2025-05-09 13:05:19,704 INFO    MainThread:723405 [wandb_init.py:init():915] updated telemetry
2025-05-09 13:05:19,714 INFO    MainThread:723405 [wandb_init.py:init():939] communicating run to backend with 90.0 second timeout
2025-05-09 13:05:20,297 INFO    MainThread:723405 [wandb_init.py:init():1014] starting run threads in backend
2025-05-09 13:05:20,438 INFO    MainThread:723405 [wandb_run.py:_console_start():2454] atexit reg
2025-05-09 13:05:20,438 INFO    MainThread:723405 [wandb_run.py:_redirect():2306] redirect: wrap_raw
2025-05-09 13:05:20,438 INFO    MainThread:723405 [wandb_run.py:_redirect():2371] Wrapping output streams.
2025-05-09 13:05:20,438 INFO    MainThread:723405 [wandb_run.py:_redirect():2394] Redirects installed.
2025-05-09 13:05:20,441 INFO    MainThread:723405 [wandb_init.py:init():1056] run started, returning control to user process
2025-05-09 13:05:20,442 INFO    MainThread:723405 [wandb_run.py:_config_callback():1327] config_cb None None {'conditioning_type': 'image', 'controlnet_architecture': 'original', 'pretrained_model_name_or_path': 'stable-diffusion-v1-5/stable-diffusion-v1-5', 'controlnet_model_name_or_path': None, 'reward_model_name_or_path': 'ARCFACE/models/glintr100.onnx', 'revision': None, 'grad_scale': 0.5, 'tokenizer_name': None, 'output_dir': 'identity_controlnet', 'cache_dir': None, 'seed': None, 'resolution': 512, 'guidance_scale': 1.0, 'controlnet_conditioning_scale': 1.0, 'control_guidance_start': 0.0, 'control_guidance_end': 1.0, 'train_batch_size': 4, 'num_train_epochs': 50, 'max_train_steps': 295200, 'checkpointing_steps': 500, 'checkpoints_total_limit': None, 'resume_from_checkpoint': None, 'gradient_accumulation_steps': 1, 'gradient_checkpointing': False, 'learning_rate': 5e-06, 'scale_lr': False, 'lr_scheduler': 'constant', 'lr_warmup_steps': 500, 'lr_num_cycles': 1, 'lr_power': 1.0, 'use_8bit_adam': False, 'dataloader_num_workers': 16, 'adam_beta1': 0.9, 'adam_beta2': 0.999, 'adam_weight_decay': 0.01, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'push_to_hub': False, 'hub_token': None, 'hub_model_id': 'limingcv/reward_controlnet', 'logging_dir': 'logs', 'timestep_sampling_start': 0, 'timestep_sampling_end': 1000, 'min_timestep_rewarding': 0, 'max_timestep_rewarding': 200, 'allow_tf32': False, 'use_ema': False, 'non_ema_revision': None, 'report_to': 'wandb', 'mixed_precision': None, 'enable_xformers_memory_efficient_attention': False, 'set_grads_to_none': False, 'task_name': 'identity', 'dataset_name': 'Milocas/celebahq_masked', 'keep_in_memory': False, 'dataset_config_name': None, 'train_data_dir': None, 'wrong_ids_file': None, 'image_column': 'image', 'conditioning_image_column': 'condition', 'caption_column': '', 'label_column': None, 'max_train_samples': None, 'max_val_samples': 10, 'image_condition_dropout': 0, 'text_condition_dropout': 0, 'all_condition_dropout': 0, 'num_validation_images': 2, 'validation_steps': 500, 'tracker_project_name': 'reward_controlnet'}
2025-05-09 13:05:25,882 INFO    MsgRouterThr:723405 [mailbox.py:close():129] [no run ID] Closing mailbox, abandoning 1 handles.
